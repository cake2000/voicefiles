You should not make the swap after broadcasting "update".
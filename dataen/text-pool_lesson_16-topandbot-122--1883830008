You need to make 4 code changes:
The logic for the other 3 directions is very similar.
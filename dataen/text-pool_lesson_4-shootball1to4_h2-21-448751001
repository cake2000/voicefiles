This is the working solution for exercise 1.
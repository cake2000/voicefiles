For a hint, you need to change the "next x" and "next y" calculations in these 2 places.
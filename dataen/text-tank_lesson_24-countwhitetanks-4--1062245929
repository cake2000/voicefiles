Here is the logic flow. 
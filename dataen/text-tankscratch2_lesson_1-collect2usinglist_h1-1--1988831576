For a hint, here is the basic logic for the new blocks.
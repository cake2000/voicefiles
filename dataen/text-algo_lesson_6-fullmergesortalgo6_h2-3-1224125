Note that we need to calculate "middle" again before using it,
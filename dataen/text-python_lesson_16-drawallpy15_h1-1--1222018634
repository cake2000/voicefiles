Here is a partial solution with more hints.
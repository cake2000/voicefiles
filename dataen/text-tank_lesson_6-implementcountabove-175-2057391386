and returns treeCount at the end.
Therefore, we should try to refactor the highlighted core logic into a new function.
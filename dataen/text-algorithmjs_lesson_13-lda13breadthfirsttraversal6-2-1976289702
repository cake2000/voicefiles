Let's write it down in pseudo-code first. 
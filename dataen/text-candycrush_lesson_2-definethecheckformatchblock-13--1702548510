The logic for this block is fairly simple:
This method is based on multi-branched recursion. 
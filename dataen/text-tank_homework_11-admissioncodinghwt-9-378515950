According to the formula, student S3 has the highest weighted score of 28.
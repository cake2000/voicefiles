This is the full solution.
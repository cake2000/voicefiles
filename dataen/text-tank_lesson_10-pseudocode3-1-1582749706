Here is the newly updated pseudo code,
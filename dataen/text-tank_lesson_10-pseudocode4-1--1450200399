Here is the complete pseudo code.
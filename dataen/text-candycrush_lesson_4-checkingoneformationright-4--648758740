To simplify the main logic, 
there are many places in the new function that you need to swap the logic for x and y.
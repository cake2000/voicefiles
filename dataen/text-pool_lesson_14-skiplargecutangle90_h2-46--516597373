Here is the full solution for exercise 1.
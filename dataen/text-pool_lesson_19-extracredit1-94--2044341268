Can you add this check to your get end state distance function?
The recursive case is a little complicated.
The script is working well, but it is too long.
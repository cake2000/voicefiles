The time complexity of this method is O(M log N).
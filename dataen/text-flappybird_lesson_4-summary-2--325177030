and then we added some new logic to dynamically determine the waiting time.
As a hint, this is very similar to the code that picks a better tool based on cost.
the space complexity is the square of N. 
Here is the full solution.
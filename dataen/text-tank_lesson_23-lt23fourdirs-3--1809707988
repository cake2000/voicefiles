Here is the pseudo code. 
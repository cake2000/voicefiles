I made a copy of the old code, and modified the variable names to work with pocket 3.
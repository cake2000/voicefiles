The basic idea is to use a new variable "best distance",
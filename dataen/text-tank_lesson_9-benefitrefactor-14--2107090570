and also greatly simplified the get new command function.
Note that these 3 repeat loops need to be replaced.
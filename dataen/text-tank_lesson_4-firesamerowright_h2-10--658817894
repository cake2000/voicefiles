Here is a working solution for exercise 2.
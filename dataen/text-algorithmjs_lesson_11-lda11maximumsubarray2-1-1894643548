Let's start from an intuitive solution and optimize it gradually. 
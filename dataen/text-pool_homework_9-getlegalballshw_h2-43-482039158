Here is the full solution for this exercise.
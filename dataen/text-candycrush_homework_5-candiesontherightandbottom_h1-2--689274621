The logic for r is similar.
Dynamic programming applies to this kind of problems.
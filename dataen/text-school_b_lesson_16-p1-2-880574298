This is the result after adding all the checks.
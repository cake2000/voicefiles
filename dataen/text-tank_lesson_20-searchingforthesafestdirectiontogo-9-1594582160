and update the record if necessary. 
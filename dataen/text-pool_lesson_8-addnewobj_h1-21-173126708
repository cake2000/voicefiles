Here is the working code with the new objects added.
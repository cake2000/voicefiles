Now let's handle the more generic situation,
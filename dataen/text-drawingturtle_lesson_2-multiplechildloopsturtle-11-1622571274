Note that we should not change "edge length" before the second loop,
Note that only 4 sides are used to reduce the computation needed.
The current script works well but is too long.
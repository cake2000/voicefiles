I have modified the comparisons for offsets 3 to 5 to use "mod 6".
You need to broadcast the "swap" message at the end to trigger the swap.
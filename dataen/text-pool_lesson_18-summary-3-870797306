In addition, you have implemented some rules to determine whether to run the full search or not.
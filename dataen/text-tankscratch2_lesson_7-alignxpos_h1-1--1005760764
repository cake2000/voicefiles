For a hint, this is the main logic of the new block.
It should determine which movement command to send based on the "last dir".
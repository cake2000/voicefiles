You need to handle the case when an offset is empty.
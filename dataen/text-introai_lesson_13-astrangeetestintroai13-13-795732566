The problem really comes from this line,
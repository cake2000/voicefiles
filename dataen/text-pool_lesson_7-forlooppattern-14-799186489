Now the remaining code can be represented by a template like this,
This is the solution for exercise 6. 
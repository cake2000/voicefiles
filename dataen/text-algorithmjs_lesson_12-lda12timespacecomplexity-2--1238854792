Now, let's analyze the time and space complexities of this solution. 
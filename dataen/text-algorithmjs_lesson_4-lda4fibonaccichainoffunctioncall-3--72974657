There are some duplicated calculations. 
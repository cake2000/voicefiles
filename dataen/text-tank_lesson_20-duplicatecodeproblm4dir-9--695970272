Can you think about how to avoid the duplicate code?